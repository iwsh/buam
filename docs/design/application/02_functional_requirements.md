# 2. 機能要件定義

本ドキュメントは、「buam」アプリケーションの機能要件を定義する。
初期リリースでは、`01_overview.md` にて定義した「自動車関連経費の管理」に焦点を当てる。

## 2.1. ユーザー種別

本アプリケーションは、以下のユーザー種別を定義する。

| 種別 | 概要 |
| :--- | :--- |
| **Adminユーザー** | 全てのユーザー情報を管理し、新規ユーザーの招待・作成を行うことができる。<br>加えて、一般ユーザーが可能な全ての操作（自身の経費情報管理など）も行える。 |
| **一般ユーザー** | 自身の経費情報を管理する。他のユーザー情報は閲覧・操作できない。 |

## 2.2. 機能一覧

| 大項目 | 中項目 | 機能概要 | 備考 |
| :--- | :--- | :--- | :--- |
| **1. ユーザー管理** | 1.1. ユーザー招待 | Adminユーザーが、新規ユーザーをメールアドレスで招待できる。 | |
| | 1.2. ユーザー登録 | 招待されたユーザーが、自身の情報を登録しアカウントを有効化する。 | |
| | 1.3. ログイン・ログアウト | 登録済みユーザーが認証を行い、セッションを管理できる。 | ・メールアドレスとパスワードによるログイン<br>・ソーシャルログイン（Google等を想定） |
| | 1.4. パスワードリセット | パスワードを忘れた場合に再設定できる。 | パスワードログイン利用者のみ。 |
| | 1.5. ユーザー一覧表示 | Adminユーザーが、登録済みユーザーの一覧を確認できる。 | |
| **2. 初期設定** | 2.1. 車両情報登録 | ユーザーが経費計算の対象となる車両情報を登録できる。 | 車種名、ナンバープレート情報などを想定。 |
| | 2.2. 按分期間設定 | 家事按分の計算対象となる期間（例: 1月1日〜12月31日）を設定できる。 | デフォルトは当年1月1日〜12月31日。 |
| **3. 走行記録** | 3.1. 走行データ入力 | 日々の累積走行距離メーターの値と、その日の利用目的（業務/家事）を記録できる。<br>日々の走行距離は、前回の記録値との差分から自動計算される。 | シンプルなUIで数タップで入力完了を目指す。 |
| | 3.2. 走行履歴閲覧・編集 | 過去の走行記録を一覧で確認し、必要に応じて編集・削除できる。 | |
| **4. ダッシュボード** | 4.1. 業務利用割合表示 | 記録されたデータに基づき、現在の業務利用割合を自動計算して表示する。 | 按分期間内での総走行距離と業務走行距離から算出。 |
| | 4.2. 走行データ概要表示 | 月別の走行距離（合計/業務/家事）などをグラフで可視化する。 | |
| **5. 通知機能** | 5.1. プッシュ通知設定 | ユーザーがプッシュ通知の受信可否を設定できる。 | |
| | 5.2. 条件別通知 | 特定の条件を満たした場合にプッシュ通知を送信する。 | **主な条件:**<br>・前日に走行記録がない場合、翌朝に通知する。<br>・その他、管理者が設定した条件。<br><br>**技術補足:**<br>・Web Push API等を利用したサーバープッシュを想定。 |
| **6. データ出力** | 6.1. 走行履歴データ出力 | 確定申告の証憑として利用できるよう、走行履歴データをCSV形式で出力できる。 | 按分期間を指定して出力可能。 |

## 2.3. 非機能要件

| 項目 | 要件 |
| :--- | :--- |
| **パフォーマンス** | ・走行データ入力、ダッシュボード表示は3秒以内に完了すること。 |
| **ユーザビリティ** | ・主要な機能は3タップ以内でアクセス可能であること。<br>・専門知識がなくても直感的に操作できるUIであること。 |
| **セキュリティ** | ・パスワードは不可逆的に暗号化して保存すること。<br>・通信はすべてSSL/TLSで暗号化すること。<br>・ユーザーロールに基づき、適切なアクセス制御を行うこと。 |
| **互換性** | ・最新版の主要なWebブラウザ（Chrome, Safari, Firefox）で正常に動作すること。<br>・レスポンシブデザインに対応し、スマートフォンとPCの両方で快適に利用できること。 |
| **データ制約** | ・累積走行距離メーターの値は最低300,000kmまでは記録可能であること。 |
